<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Simple Dino Run</title>
<style>
  * {
    margin: 0; padding: 0; box-sizing: border-box;
  }
  body {
    background: #70c5ce;
    font-family: Arial, sans-serif;
    user-select: none;
    overflow: hidden;
    height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
  }
  #scoreboard {
    font-size: 20px;
    font-weight: bold;
    color: #333;
    margin-bottom: 10px;
  }
  #info {
    font-size: 14px;
    color: #555;
    margin-bottom: 15px;
  }
  #game {
    position: relative;
    width: 700px;
    height: 180px;
    background: linear-gradient(to top, #87ceeb 0%, #ccefff 100%);
    border-radius: 15px;
    overflow: hidden;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
  }
  #ground {
    position: absolute;
    bottom: 0;
    width: 200%;
    height: 40px;
    background: linear-gradient(90deg, #654321 0%, #7a4f25 50%, #654321 100%);
    background-size: 80px 40px;
    animation: groundMove 1.5s linear infinite;
  }
  @keyframes groundMove {
    0% { background-position: 0 0; }
    100% { background-position: -80px 0; }
  }
  #player {
    position: absolute;
    bottom: 40px;
    left: 60px;
    width: 50px;
    height: 50px;
    background: url('https://i.imgur.com/jIKY3kH.png') no-repeat center/contain;
    transition: bottom 0.2s ease;
    z-index: 10;
  }
  #monster {
    position: absolute;
    bottom: 40px;
    left: 10px;
    width: 80px;
    height: 80px;
    background: url('https://i.imgur.com/UHlOc9t.png') no-repeat center/contain;
    opacity: 0.6;
    z-index: 9;
    transition: left 0.2s ease;
  }
  .obstacle {
    position: absolute;
    bottom: 40px;
    width: 30px;
    height: 50px;
    background: url('https://i.imgur.com/fnC3WKn.png') no-repeat center/contain;
    border-radius: 5px;
    z-index: 9;
  }
  .obstacle.ball {
    border-radius: 50%;
    width: 40px !important;
    height: 40px !important;
  }
</style>
</head>
<body>

<div id="scoreboard">Score: 0 | High Score: 0</div>
<div id="info">Controls: Space = Jump, â†“ = Duck, Shift = Sprint, Enter = Restart</div>
<div id="game">
  <div id="monster"></div>
  <div id="player"></div>
  <div id="ground"></div>
</div>

<script>
  const game = document.getElementById('game');
  const player = document.getElementById('player');
  const monster = document.getElementById('monster');
  const scoreboard = document.getElementById('scoreboard');

  let jumping = false;
  let ducking = false;
  let sprinting = false;
  let playerBottom = 0;
  const gravity = 0.7;
  let velocity = 0;
  let obstacles = [];
  let score = 0;
  let highScore = 0;
  let gameOver = false;

  // Player jump height & speed
  const jumpPower = 15;

  // Speeds (pixels per frame)
  let obstacleSpeed = 6;
  let monsterBaseLeft = 10;
  let monsterLeft = monsterBaseLeft;
  const monsterSpeed = 0.8;

  // Obstacle spawn timing
  let nextObstacleIn = 0;

  if(localStorage.getItem('simpleDinoHighScore')) {
    highScore = parseInt(localStorage.getItem('simpleDinoHighScore'));
  }
  updateScoreboard();

  function jump() {
    if (!jumping && !ducking) {
      jumping = true;
      velocity = jumpPower;
    }
  }

  function duck(state) {
    ducking = state;
    if (ducking) {
      player.style.height = '25px';
      player.style.bottom = '40px';
    } else {
      player.style.height = '50px';
      player.style.bottom = (playerBottom + 40) + 'px';
    }
  }

  function createObstacle() {
    const obstacle = document.createElement('div');
    obstacle.classList.add('obstacle');
    if (Math.random() < 0.3) {
      obstacle.classList.add('ball');
    }
    obstacle.style.right = '-40px';
    game.appendChild(obstacle);
    obstacles.push({el: obstacle, pos: game.clientWidth, isBall: obstacle.classList.contains('ball')});
  }

  function updateScoreboard() {
    scoreboard.textContent = `Score: ${score} | High Score: ${highScore}`;
  }

  function resetGame() {
    obstacles.forEach(o => o.el.remove());
    obstacles = [];
    score = 0;
    gameOver = false;
    playerBottom = 0;
    velocity = 0;
    monsterLeft = monsterBaseLeft;
    player.style.bottom = '40px';
    player.style.height = '50px';
    updateScoreboard();
  }

  function gameLoop() {
    if (gameOver) return;

    // Jumping physics
    if (jumping) {
      velocity -= gravity;
      playerBottom += velocity;
      if (playerBottom <= 0) {
        playerBottom = 0;
        jumping = false;
      }
      if(!ducking) {
        player.style.bottom = playerBottom + 40 + 'px';
      }
    }

    // Move obstacles
    obstacles.forEach((obs, i) => {
      obs.pos -= obstacleSpeed;
      obs.el.style.right = obs.pos + 'px';

      // Collision detection with player (simple box check)
      if (
        obs.pos < 90 && obs.pos > 40 && // horizontal overlap range
        (
          (!obs.isBall && !ducking && playerBottom < 60) || // obstacle is rock and player not ducking and low
          (obs.isBall && playerBottom < 40) // obstacle ball and player low on ground
        )
      ) {
        gameOver = true;
        if(score > highScore) {
          highScore = score;
          localStorage.setItem('simpleDinoHighScore', highScore);
        }
        scoreboard.textContent = `Game Over! Final Score: ${score} | High Score: ${highScore}`;
      }

      // Remove obstacles out of view and increase score
      if (obs.pos < -50) {
        obs.el.remove();
        obstacles.splice(i,1);
        if (!gameOver) {
          score++;
          updateScoreboard();
        }
      }
    });

    // Spawn new obstacle randomly every ~1.5-3 sec
    nextObstacleIn -= 16;
    if(nextObstacleIn <= 0 && !gameOver) {
      createObstacle();
      nextObstacleIn = 1500 + Math.random() * 1500;
    }

    // Move monster slowly towards player base position
    if(monsterLeft < 50) {
      monsterLeft += monsterSpeed;
    }
    monster.style.left = monsterLeft + 'px';

    requestAnimationFrame(gameLoop);
  }

  document.addEventListener('keydown', e => {
    if(e.code === 'Space') {
      e.preventDefault();
      jump();
    }
    if(e.code === 'ArrowDown') {
      e.preventDefault();
      duck(true);
    }
    if(e.code === 'ShiftLeft' || e.code === 'ShiftRight') {
      sprinting = true;
      obstacleSpeed = 12;
    }
    if(e.code === 'Enter' && gameOver) {
      resetGame();
      gameLoop();
    }
  });

  document.addEventListener('keyup', e => {
    if(e.code === 'ArrowDown') {
      e.preventDefault();
      duck(false);
    }
    if(e.code === 'ShiftLeft' || e.code === 'ShiftRight') {
      sprinting = false;
      obstacleSpeed = 6;
    }
  });

  // Start game loop
  gameLoop();
</script>

</body>
</html>
